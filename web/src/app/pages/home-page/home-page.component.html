<div class="flex flex-col items-center min-h-fit bg-white pt-4">
  <h1 class="text-3xl font-bold mb-4 text-center">
    Video Stabilizer
  </h1>
  <div class="window md:w-11/12 sm:w-full flex-grow mx-auto bg-orange-50 rounded-xl sm:mx-4 md:mx-0">
    <app-upload-component></app-upload-component> 
    <div *ngIf="!webSocketService.start_processing">
      <div class="flex flex-col md:flex-grow md:overflow-hidden rounded-lg bg-white p-6 shadow-xl sm:mx-6 md:mx-10 mb-10 mt-6">
        <div class="text-xl font-medium text-black text-center pb-6">What is this app?</div>
          <p class="text-gray-500">This application uses a <b>three-step block</b> matching algorithm for motion estimation as part of a video stabilization process. This involves dividing the video frames into <b>macroblocks</b> and comparing these blocks to nearby frames. <b>Motion vectors</b> are then created that model the movement of the macroblocks. 
            <b>Global motion vectors</b> are subsequently obtained by averaging the motion vectors of the macroblocks, frame by frame.</p>
          <p class="text-gray-500">In the <b>motion filtering</b> phase, the <b>Frame Position Smoothing</b> method is used. This calculates a <b>corrective motion vector</b> based on the difference between the <b>actual</b> and <b>estimated positions</b> of a point in a frame. The estimated position is obtained by applying a <b>Fourier transform</b> to the position variation of a point over time and using a <b>low pass filter</b>.</p>
          <p class="text-gray-500">In the <b>post-processing</b> stage, the frames are <b>cropped</b> to produce a stable video output.</p>
          <p class="text-gray-500"> The parameters:</p>
            <ul class="text-gray-500 list-disc pl-5 pb-5">
              <li>Block Size and Search Range are related to the motion estimation process:
                <ul class="list-disc pl-5">
                  <li>
                    <b>Block Size</b> refers to the size of the macroblocks into which the frames are divided. Lower values take more time to process.
                  </li>
                  <li>
                    <b>Search Range</b> is a measure of potential motion. A larger value indicates a greater potential motion and a higher likelihood of finding a good match.
                    A larger value should be used if the jitter is particularly strong.
                  </li>
                </ul>
              </li>
              <li><b>Filter Intensity</b> is correlated to sigma because FPS uses a Gaussian filter LPF to reduce high frequencies. A larger value means stronger filtering.</li>
              <li><b>Post-processing Crop</b> allows you to choose whether to crop the processed video. Choosing not to crop the video may result in black borders on your result.</li>
              <li><b>Compare Motion</b> allows you to choose if you want to compare the original cropped video and the smoothed cropped video using motion estimation. This will produce statistics comparing the jitter in both videos. Mind that this will take extra time for processing. </li>
            </ul>
            <hr>
          <p class="text-gray-500 pt-6"><b>Note:</b> Accepted file types are .avi, .MOV, and .mp4. Preview only works with .mp4 files due to browser video implementation, but the app can process .avi and .MOV files as well. No preview is provided for these formats.</p>
      </div>     
    </div> 
    <div *ngIf="webSocketService.start_processing" class="flex flex-col md:flex-row mt-8 w-full h-full sm:px-8 md:px-0 mb-8">
      <div class="stats-inverted-border-left flex flex-col md:flex-grow rounded-lg bg-white p-6 w-full md:w-1/3 h-full md:mr-5 md:rounded-l-none shadow-trb">
        <app-processing-component class="flex-grow"></app-processing-component>
      </div>
      <div class="stats-inverted-border-right flex flex-col md:flex-grow rounded-lg bg-white p-6 md:w-2/3 md:ml-5 md:rounded-r-none shadow-tlb sm:mt-8 md:mt-0">
        <app-stats-download class="flex-grow"></app-stats-download>
      </div>
    </div> 
          
  </div>
  
</div>
<app-footer></app-footer>

